---
layout: post
comments: true
description: Merge k Sorted LinkedLists using PriorityQueue
date: 2017-08-24 19:41:00
title: Merge k Sorted Lists
category: Coding
tags: [Algorithm, String, Leetcode, Hard, Java]
---

**Description**
[leetcode 23](https://leetcode.com/problems/merge-k-sorted-lists/description/)
Merge k sorted linked lists and return it as one sorted list. Analyze and describe its complexity.

## Un-optimized version of code (timed out)
This version timed out when there are 1000 singleton ListNodes as input.

```java
class Solution {
    public ListNode mergeKLists(ListNode[] lists) {
        int minPos = -1;
        int minVal = Integer.MAX_VALUE;
        int nodeCount = 0;
        for (int i=0; i<lists.length; i++) {
            if (lists[i] != null) {
                nodeCount++;
                if (lists[i].val <= minVal) {
                    minVal = lists[i].val;
                    minPos = i;
                }
            }
        }
        if (nodeCount==1)   return lists[minPos]; // early terminating
        
        if (minPos==-1) return null; // edge case that all input nodes are null
        
        ListNode ret = lists[minPos];
        lists[minPos] = lists[minPos].next;
        ret.next = mergeKLists(lists);
        
        return ret;
    }
}

```

## Un-optimized version using Priority Queue
TODO: add time complexity analysis.

```java
/**
 * Definition for singly-linked list.
 * public class ListNode {
 *     int val;
 *     ListNode next;
 *     ListNode(int x) { val = x; }
 * }
 */
class Solution {
    public ListNode mergeKLists(ListNode[] lists) {
        if (lists.length==0)    return null;
        Queue<ListNode> pq = new PriorityQueue<>(lists.length, new Comparator<ListNode>(){
            @Override
            public int compare(ListNode o1,ListNode o2){
                if (o1.val<o2.val)
                    return -1;
                else if (o1.val==o2.val)
                    return 0;
                else 
                    return 1;
            }
        });
        
        for (ListNode node : lists) {
            if (node!=null) pq.add(node);
        }
        return mergeKLists(pq);
    }
    
    private ListNode mergeKLists(Queue<ListNode> pq) {
        if (pq.size()<=1) {
            return pq.poll(); // null or the singleton
        }
        ListNode ret = pq.poll();
        if (ret.next!=null) {
            pq.add(ret.next);
        }
        
        ret.next = mergeKLists(pq);
        
        return ret;
    }
}
```

![img]({{ site.baseurl | prepend:site.url}}/images/23_java.jpg){: .center-image }*Runtime: 20ms*

