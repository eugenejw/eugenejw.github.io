<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Weihan's Coding Blog | Find Duplicate File in System (leetcode 609) </title>
  <meta name="theme-color" content="#222222" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/header.js"></script>
  <script src="/js/toc.js"></script>
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/theme.css" rel="stylesheet">
  <link href="/css/syntax.css" rel="stylesheet">
  <link href="/css/font-awesome/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>

  
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-74090658-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


  


 <script type="text/javascript">
  WebFontConfig = {
    google: {
      families: ['Ubuntu::latin']
    }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
</script>

  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">Weihan's Coding Blog</a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="/">/home</a></li>
          <li><a href="/archive.html">/archive</a></li>
          <li><a href="/tags.html">/tags</a></li>
          <li><a href="/about.html">/about</a></li>
        </ul>
      </div>
    </div>
  </nav>

    <div class="wrapper">
      <div class="content">
        <div class="container container-center">
          <div class="row">
            <div class="col-md-8">
              <div class="article">
                <div class="well">
                  <h1><a href="/2017/07/leetcode-609">Find Duplicate File in System (leetcode 609)</a></h1>
                  <div class="post-meta">
                    <div class="post-time">
                      <i class="fa fa-calendar"></i>
                      <time>28 Jul 2017</time>
                    </div>
                    <ul>
                      
                        <li><a href="/tag/Algorithm">Algorithm</a></li>
                      
                        <li><a href="/tag/Caching">Caching</a></li>
                      
                        <li><a href="/tag/Leetcode">Leetcode</a></li>
                      
                        <li><a href="/tag/Medium">Medium</a></li>
                      
                        <li><a href="/tag/Java">Java</a></li>
                      
                    </ul>
                  </div>
                  <div class="post-content">
                    <div id="toc" class="toc"></div>
                    <p><strong>Description</strong>,<br />
Given a list of directory info including directory path, and all the files with contents in this directory, you need to find out all the groups of duplicate files in the file system in terms of their paths.</p>

<p>A group of duplicate files consists of at least two files that have exactly the same content.</p>

<p>A single directory info string in the input list has the following format:</p>

<p>“root/d1/d2/…/dm f1.txt(f1_content) f2.txt(f2_content) … fn.txt(fn_content)”</p>

<p>It means there are n files (f1.txt, f2.txt … fn.txt with content f1_content, f2_content … fn_content, respectively) in directory root/d1/d2/…/dm. Note that n &gt;= 1 and m &gt;= 0. If m = 0, it means the directory is just the root directory.</p>

<p>The output is a list of group of duplicate file paths. For each group, it contains all the file paths of the files that have the same content. A file path is a string that has the following format:</p>

<p>“directory_path/file_name.txt”</p>

<p>Example 1:</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="nl">Input:</span>
<span class="o">[</span><span class="s">"root/a 1.txt(abcd) 2.txt(efgh)"</span><span class="o">,</span> <span class="s">"root/c 3.txt(abcd)"</span><span class="o">,</span> <span class="s">"root/c/d 4.txt(efgh)"</span><span class="o">,</span> <span class="s">"root 4.txt(efgh)"</span><span class="o">]</span>
<span class="nl">Output:</span>  
<span class="o">[[</span><span class="s">"root/a/2.txt"</span><span class="o">,</span><span class="s">"root/c/d/4.txt"</span><span class="o">,</span><span class="s">"root/4.txt"</span><span class="o">],[</span><span class="s">"root/a/1.txt"</span><span class="o">,</span><span class="s">"root/c/3.txt"</span><span class="o">]]</span>
</code></pre>
</div>

<p>Note:<br />
No order is required for the final output.<br />
You may assume the directory name, file name and file content only has letters and digits, and the length of file content is in the range of [1,50].<br />
The number of files given is in the range of [1,20000].<br />
You may assume no files or directories share the same name in the same directory.<br />
You may assume each given directory info represents a unique directory. Directory path and file info are separated by a single blank space.</p>

<p>Follow-up beyond contest:<br />
Imagine you are given a real file system, how will you search files? DFS or BFS?<br />
If the file content is very large (GB level), how will you modify your solution?<br />
If you can only read the file by 1kb each time, how will you modify your solution?<br />
What is the time complexity of your modified solution? What is the most time-consuming part and memory consuming part of it? How to optimize?<br />
How to make sure the duplicated files you find are not false positive?</p>

<h2 id="hashmap-solution">HashMap solution</h2>

<p>Though the content of [1 - 50] length can add up to 50 factorial keys, the description said the file count is in range of [1, 20000], which is not bad to use the file content as the key of hashmap.</p>

<p>Time complexity : O(n).<br />
Space complexity : O(n).</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">findDuplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paths</span><span class="p">):</span>
        <span class="s">"""
        :type paths: List[str]
        :rtype: List[List[str]]
        """</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">hm</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buildHashMap</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">hm</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">hm</span><span class="o">.</span><span class="n">itervalues</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span>

        
    <span class="k">def</span> <span class="nf">buildHashMap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">hm</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
            <span class="n">tmpList</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="n">tmpList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmpList</span><span class="p">)):</span>
                <span class="n">fileName</span><span class="p">,</span> <span class="n">fileContent</span> <span class="o">=</span> <span class="n">tmpList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'('</span><span class="p">)</span>
                <span class="n">fileContent</span> <span class="o">=</span> <span class="n">fileContent</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">fileContent</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">fileContent</span><span class="p">,</span> <span class="p">[])</span>
                <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">fileName</span><span class="p">)</span>
            
</code></pre>
</div>

<p><img src="http://localhost:4000/images/609_python.jpg" alt="img" class="center-image" /><em>Runtime: 246ms</em></p>

<p>Follow-up beyond contest:<br />
Imagine you are given a real file system, how will you search files? DFS or BFS?<br />
Answer: Comparing BFS and DFS, the big advantage of DFS is that it has much lower memory requirements than BFS, because it’s not necessary to store all of the child pointers at each level. Depending on the data and what you are looking for, either DFS or BFS could be advantageous. In this specific case, I prefer DFS.</p>

<p>If the file content is very large (GB level), how will you modify your solution?<br />
Answer: use file size + file’s MD5. In worst case, we need to compare the files byte by byte.</p>

<p>If you can only read the file by 1kb each time, how will you modify your solution?<br />
Answer: it is not an issue since majority of our files can be differentiate with size + MD5.</p>

<p>What is the time complexity of your modified solution? What is the most time-consuming part and memory consuming part of it? How to optimize?<br />
Answer: O(n^2) in worst case scenario.</p>

<p>How to make sure the duplicated files you find are not false positive?</p>


                    

                  </div>
                  
                </div>
              </div>
            </div>
            <div class="col-md-4 hidden-xs">
              <div class="sidebar ">
  <h2>Recent Posts</h2>
  <ul>
    
    <li><a href="/2017/07/leetcode-237">Delete Node in a Linked List (leetcode 273)</a></li>
    
    <li><a href="/2017/07/leetcode-148">Sort List (leetcode 148)</a></li>
    
    <li><a href="/2017/07/leetcode-609">Find Duplicate File in System (leetcode 609)</a></li>
    
    <li><a href="/2017/07/leetcode-565">Array Nesting (leetcode 565)</a></li>
    
    <li><a href="/2017/07/leetcode-108">Convert Sorted Array to Binary Search Tree (leetcode 108)</a></li>
    
  </ul>
</div>

<div class="sidebar">
  <h2>Tags</h2>
  <ul class="sideBarTags">
    
    
    <li>
      <a href="/tag/Algorithm" data-toggle="tooltip" data-placement="right" title="24">
        <span>Algorithm</span></a></li>
    
    <li>
      <a href="/tag/Amazon" data-toggle="tooltip" data-placement="right" title="1">
        <span>Amazon</span></a></li>
    
    <li>
      <a href="/tag/Array" data-toggle="tooltip" data-placement="right" title="2">
        <span>Array</span></a></li>
    
    <li>
      <a href="/tag/BFS" data-toggle="tooltip" data-placement="right" title="2">
        <span>BFS</span></a></li>
    
    <li>
      <a href="/tag/Binary Search" data-toggle="tooltip" data-placement="right" title="1">
        <span>Binary Search</span></a></li>
    
    <li>
      <a href="/tag/Bits Operations" data-toggle="tooltip" data-placement="right" title="1">
        <span>Bits Operations</span></a></li>
    
    <li>
      <a href="/tag/Boyer–Moore–Horspool algorithm" data-toggle="tooltip" data-placement="right" title="1">
        <span>Boyer–Moore–Horspool algorithm</span></a></li>
    
    <li>
      <a href="/tag/Brutal" data-toggle="tooltip" data-placement="right" title="1">
        <span>Brutal</span></a></li>
    
    <li>
      <a href="/tag/Caching" data-toggle="tooltip" data-placement="right" title="3">
        <span>Caching</span></a></li>
    
    <li>
      <a href="/tag/Combination" data-toggle="tooltip" data-placement="right" title="1">
        <span>Combination</span></a></li>
    
    <li>
      <a href="/tag/DFS" data-toggle="tooltip" data-placement="right" title="7">
        <span>DFS</span></a></li>
    
    <li>
      <a href="/tag/Easy" data-toggle="tooltip" data-placement="right" title="8">
        <span>Easy</span></a></li>
    
    <li>
      <a href="/tag/HashMap" data-toggle="tooltip" data-placement="right" title="1">
        <span>HashMap</span></a></li>
    
    <li>
      <a href="/tag/Hashmap" data-toggle="tooltip" data-placement="right" title="1">
        <span>Hashmap</span></a></li>
    
    <li>
      <a href="/tag/Java" data-toggle="tooltip" data-placement="right" title="19">
        <span>Java</span></a></li>
    
    <li>
      <a href="/tag/KMP" data-toggle="tooltip" data-placement="right" title="1">
        <span>KMP</span></a></li>
    
    <li>
      <a href="/tag/Leetcode" data-toggle="tooltip" data-placement="right" title="5">
        <span>Leetcode</span></a></li>
    
    <li>
      <a href="/tag/LinkedList" data-toggle="tooltip" data-placement="right" title="2">
        <span>LinkedList</span></a></li>
    
    <li>
      <a href="/tag/Matrix" data-toggle="tooltip" data-placement="right" title="1">
        <span>Matrix</span></a></li>
    
    <li>
      <a href="/tag/Medium" data-toggle="tooltip" data-placement="right" title="16">
        <span>Medium</span></a></li>
    
    <li>
      <a href="/tag/Merge Sort" data-toggle="tooltip" data-placement="right" title="1">
        <span>Merge Sort</span></a></li>
    
    <li>
      <a href="/tag/Permutations" data-toggle="tooltip" data-placement="right" title="1">
        <span>Permutations</span></a></li>
    
    <li>
      <a href="/tag/Postorder" data-toggle="tooltip" data-placement="right" title="1">
        <span>Postorder</span></a></li>
    
    <li>
      <a href="/tag/Preorder" data-toggle="tooltip" data-placement="right" title="2">
        <span>Preorder</span></a></li>
    
    <li>
      <a href="/tag/Python" data-toggle="tooltip" data-placement="right" title="14">
        <span>Python</span></a></li>
    
    <li>
      <a href="/tag/Regex" data-toggle="tooltip" data-placement="right" title="1">
        <span>Regex</span></a></li>
    
    <li>
      <a href="/tag/Space Complexity" data-toggle="tooltip" data-placement="right" title="1">
        <span>Space Complexity</span></a></li>
    
    <li>
      <a href="/tag/Stack" data-toggle="tooltip" data-placement="right" title="1">
        <span>Stack</span></a></li>
    
    <li>
      <a href="/tag/String" data-toggle="tooltip" data-placement="right" title="2">
        <span>String</span></a></li>
    
    <li>
      <a href="/tag/Tree" data-toggle="tooltip" data-placement="right" title="8">
        <span>Tree</span></a></li>
    
    <li>
      <a href="/tag/backtracing" data-toggle="tooltip" data-placement="right" title="1">
        <span>backtracing</span></a></li>
    
    <li>
      <a href="/tag/jekyll" data-toggle="tooltip" data-placement="right" title="8">
        <span>jekyll</span></a></li>
    
    <li>
      <a href="/tag/leetcode" data-toggle="tooltip" data-placement="right" title="19">
        <span>leetcode</span></a></li>
    
  </ul>
</div>

            </div>
          </div>
        </div>
        

      </div>
          <footer class="footer-distributed">
      <div class="container">
        <div class="footer">
          <p>Weihan Jiang &copy; 2017</p>
          <h6>Follow me</h6>

<ul class="social-media">

  
    <li>
      <a title="eugenejw on Github" href="https://github.com/eugenejw" target="_blank"><i class="fa fa-github fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title=" on StackOverflow" href="https://stackoverflow.com/users/" target="_blank"><i class="fa fa-stack-overflow fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title="weihan-jiang-6219096b on LinkedIn" href="https://www.linkedin.com/in/weihan-jiang-6219096b" target="_blank"><i class="fa fa-linkedin fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title=" on Instagram" href="https://instagram.com/" target="_blank"><i class="fa fa-instagram fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title=" on Last.fm" href="https://www.lastfm.com/user/" target="_blank"><i class="fa fa-lastfm fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title="feed.xml RSS" href="/feed.xml" target="_blank"><i class="fa fa-rss fa-2x"></i></a>
    </li>
  

</ul>

        </div>
      </div>
    </footer>

    </div>
  </body>
</html>
